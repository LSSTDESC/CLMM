<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>clmm.support.mock_data module &mdash; CLMM 1.4.5 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="clmm.support.sampler module" href="clmm.support.sampler.html" />
    <link rel="prev" title="clmm.support package" href="clmm.support.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> CLMM
          </a>
              <div class="version">
                1.4.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/overview.html">Rapid overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/citing.html">Using and citing CLMM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage Demos</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/demo_generate_mock_cluster.html">Generate Mock Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/demo_dataops_functionality.html">Measure a Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/demo_theory_functionality.html">Model a Galaxy Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/data_and_model_demo_DC2.html">Basic usage of the cosmoDC2 extragalactic catalog with CLMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Compare_NFW_critical_massdef.html">Compare NFW profile for the CLMM backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Compare_NFW_critical_massdef.html#comparison-of-nfw-with-mass-definition-based-on-the-critical-density-of-the-universe-for-the-various-backends">Comparison of NFW with mass definition based on the critical density of the universe for the various backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Compare_NFW_critical_massdef.html#compare-all-to-colossus">Compare all to Colossus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/demo_mass_conversion.html">Mass conversion between spherical overdensity mass definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/demo_boost_factors.html">Compute boost factors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Mass Fitting Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example1_Fit_Halo_Mass_to_Shear_Catalog.html">Fit halo mass to shear profile: 1. ideal data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example2_Fit_Halo_Mass_to_Shear_Catalog.html">Fit halo mass to shear profile: 2. realistic data and wrong model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example3_Fit_Halo_Mass_to_Shear_Catalog.html">Fit halo mass to shear profile: 3. accounting for the redshift distribution of source galaxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example1_Fit_shear_profile_with_miscentering.html">Investigate the impact of miscentering on shear profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example4_Fit_Halo_mass_to_HSC_data.html">Using CLMM on Real Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Compare_NFW_critical_massdef.html">Compare NFW profile for the CLMM backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Compare_NFW_critical_massdef.html#comparison-of-nfw-with-mass-definition-based-on-the-critical-density-of-the-universe-for-the-various-backends">Comparison of NFW with mass definition based on the critical density of the universe for the various backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Compare_NFW_critical_massdef.html#compare-all-to-colossus">Compare all to Colossus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example_cluster_ensemble.html">Generating a cluster catalog and associated source catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example_cluster_ensemble.html#creating-clusterensemble-object-and-estimation-of-individual-excess-surface-density-profiles">Creating ClusterEnsemble object and estimation of individual excess surface density profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example_cluster_ensemble.html#stacked-profile-of-the-cluster-ensemble">Stacked profile of the cluster ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example_cluster_ensemble.html#covariance-bootstrap-sample-jackknife-of-the-stack-between-radial-bins">Covariance (Bootstrap, sample, Jackknife) of the stack between radial bins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example_cluster_ensemble.html#visualizing-the-stacked-profiles-and-corresponding-model">Visualizing the stacked profiles and corresponding model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compiled-examples/Example_realistic_cluster_ensemble.html">Generate cluster ensemble with “realistic” mass and redshift distribution</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="clmm.clusterensemble.html">clmm.clusterensemble module</a></li>
<li class="toctree-l2"><a class="reference internal" href="clmm.constants.html">clmm.constants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="clmm.cosmology.html">clmm.cosmology package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="clmm.cosmology.ccl.html">clmm.cosmology.ccl module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clmm.cosmology.cluster_toolkit.html">clmm.cosmology.cluster_toolkit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clmm.cosmology.numcosmo.html">clmm.cosmology.numcosmo module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clmm.cosmology.parent_class.html">clmm.cosmology.parent_class module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="clmm.dataops.html">clmm.dataops package</a></li>
<li class="toctree-l2"><a class="reference internal" href="clmm.galaxycluster.html">clmm.galaxycluster module</a></li>
<li class="toctree-l2"><a class="reference internal" href="clmm.gcdata.html">clmm.gcdata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="clmm.theory.html">clmm.theory package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="clmm.theory.be_setup.html">clmm.theory.be_setup module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clmm.theory.ccl.html">clmm.theory.ccl module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clmm.theory.cluster_toolkit.html">clmm.theory.cluster_toolkit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clmm.theory.func_layer.html">clmm.theory.func_layer module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clmm.theory.generic.html">clmm.theory.generic module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clmm.theory.numcosmo.html">clmm.theory.numcosmo module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clmm.theory.parent_class.html">clmm.theory.parent_class module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="clmm.plotting.html">clmm.plotting package</a></li>
<li class="toctree-l2"><a class="reference internal" href="clmm.utils.html">clmm.utils module</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="clmm.support.html">clmm.support package</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">clmm.support.mock_data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clmm.support.sampler.html">clmm.support.sampler module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CLMM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API Documentation</a></li>
          <li class="breadcrumb-item"><a href="clmm.support.html">clmm.support package</a></li>
      <li class="breadcrumb-item active">clmm.support.mock_data module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/clmm.support.mock_data.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-clmm.support.mock_data">
<span id="clmm-support-mock-data-module"></span><h1>clmm.support.mock_data module<a class="headerlink" href="#module-clmm.support.mock_data" title="Permalink to this heading"></a></h1>
<p>Functions to generate mock source galaxy distributions to demo lensing code</p>
<dl class="py function">
<dt class="sig sig-object py" id="clmm.support.mock_data.generate_galaxy_catalog">
<span class="sig-prename descclassname"><span class="pre">clmm.support.mock_data.</span></span><span class="sig-name descname"><span class="pre">generate_galaxy_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zsrc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_so</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">massdef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halo_profile_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nfw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zsrc_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zsrc_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapenoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_e_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">photoz_sigma_unscaled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nretry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngal_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clmm/support/mock_data.html#generate_galaxy_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clmm.support.mock_data.generate_galaxy_catalog" title="Permalink to this definition"></a></dt>
<dd><p>Generates a mock dataset of sheared background galaxies.</p>
<p>We build galaxy catalogs following a series of steps.</p>
<p>1. Draw true redshifts of the source galaxy population. This step is described by the
parameters <cite>zsrc</cite> and <cite>zsrc_max</cite>. <cite>zsrc</cite> can be a <cite>float</cite> in which case every source is
at the given redshift or a <cite>str</cite> describing a specific model to use for the source
distribution. Currently, the only supported model for source galaxy distribution is that
of Chang et al. 2013 arXiv:1305.0793. When a model is used to describe the distribution,
<cite>zsrc_max</cite> is the maximum allowed redshift of a source galaxy.</p>
<p>2. Apply photometric redshift errors to the source galaxy population. This step is
described by the parameter <cite>photoz_sigma_unscaled</cite>. If this parameter is set to a float,
we add Gaussian uncertainty to the source redshift</p>
<div class="math notranslate nohighlight">
\[z \sim \mathcal{N}\left(z^{\rm true},
\sigma_{\rm photo-z}^{\rm unscaled}(1+z^{\rm true}) \right)\]</div>
<p>We additionally include two columns in the output catalog, <cite>pzbins</cite> and <cite>pzpdf</cite> which
desribe the photo-z distribution as a Gaussian centered at <span class="math notranslate nohighlight">\(z^{\rm true}\)</span> with a
width <span class="math notranslate nohighlight">\(\sigma_{\rm photo-z} = \sigma_{\rm photo-z}^{\rm unscaled}(1+z^{\rm true})\)</span></p>
<p>If <cite>photoz_sigma_unscaled</cite> is <cite>None</cite>, the <cite>z</cite> column in the output catalog is the true
redshift.</p>
<p>3. Draw galaxy positions. Positions are drawn in a square box around the lens position (with a
default side length of 8 Mpc) at the lens redhsift. We then convert to right ascension and
declination using the cosmology defined in <cite>cosmo</cite>.</p>
<p>4. We predict the reduced tangential shear of each using the radial distances of each source
from the lens, the source redshifts, and the lens mass, concentration, and redshift. In the
given cosmology for an NFW halo. The reduced tangential shear is then transformed into <cite>g1</cite>
and <cite>g2</cite> components.</p>
<p>5. If the <cite>shapenoise=True</cite>, intrinsic ellipticities (1,2) components are drawn from a
Gaussian distribution of width of <cite>shapenoise</cite>. These ellipticities components are then
combined with <cite>g1</cite> and <cite>g2</cite> to provide lensed ellipticies <cite>e1</cite> and <cite>e2</cite>. If
<cite>shapenoise=False</cite>, <cite>g1</cite> and <cite>g2</cite> are directly used as ellipticity components.</p>
<p>If the shape noise parameter is high, we may draw nonsensical values for ellipticities. We
ensure that we does not return any nonsensical values for derived properties. We re-draw
all galaxies with e1 or e2 outside the bounds of [-1, 1]. After 5 (default) attempts to
re-draw these properties, we return the catalog as is and throw a warning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_m</strong> (<em>float</em>) -- Cluster mass in Msun</p></li>
<li><p><strong>cluster_z</strong> (<em>float</em>) -- Cluster redshift</p></li>
<li><p><strong>cluster_c</strong> (<em>float</em>) -- Cluster concentration in the same mass definition as delta_so</p></li>
<li><p><strong>cosmo</strong> (<em>clmm.Cosmology</em><em>, </em><em>optional</em>) -- Cosmology object.</p></li>
<li><p><strong>zsrc</strong> (<em>float</em><em> or </em><em>str</em>) -- <p>Choose the source galaxy distribution to be fixed or drawn from a predefined distribution.</p>
<ul>
<li><p><cite>float</cite> : All sources galaxies at this fixed redshift;</p></li>
<li><p><cite>str</cite> : Draws individual source gal redshifts from predefined distribution. Options are:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>chang13</cite> - Chang et al. 2013 (arXiv:1305.0793);</p></li>
<li><p><cite>desc_srd</cite> - LSST/DESC Science Requirement Document (arxiv:1809.01669);</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>delta_so</strong> (<em>float</em><em>, </em><em>optional</em>) -- Overdensity density contrast used to compute the cluster mass and concentration. The
spherical overdensity mass is computed as the mass enclosed within the radius
<span class="math notranslate nohighlight">\(R_{\Delta{\rm SO}}\)</span> where the mean matter density is <span class="math notranslate nohighlight">\(\Delta_{\rm SO}\)</span> times
the mean (or critical, depending on the massdef keyword) density of the Universe at the
cluster redshift
<span class="math notranslate nohighlight">\(M_{\Delta{\rm SO}}=4/3\pi\Delta_{\rm SO}\rho_{m}(z_{\rm lens})R_{\Delta{\rm SO}}^3\)</span></p></li>
<li><p><strong>massdef</strong> (<em>string</em><em>, </em><em>optional</em>) -- Definition the mass overdensity with respect to the 'mean' or 'critical' density of the
universe. Default is 'mean' as it works for all theory backends. The NumCosmo and CCL
backends also allow the use of 'critical'.  (letter case independent)</p></li>
<li><p><strong>halo_profile_model</strong> (<em>string</em><em>, </em><em>optional</em>) -- Halo density profile. Default is 'nfw', which works for all theory backends. The NumCosmo
backend allow for more options, e.g. 'einasto' or 'burkert' profiles (letter case
independent).</p></li>
<li><p><strong>zsrc_min</strong> (<em>float</em><em>, </em><em>optional</em>) -- The minimum true redshift of the sources. If photoz errors are included, the observed
redshift may be smaller than zsrc_min.</p></li>
<li><p><strong>zsrc_max</strong> (<em>float</em><em>, </em><em>optional</em>) -- The maximum true redshift of the sources, apllied when galaxy redshifts are drawn from a
redshift distribution. If photoz errors are included, the observed redshift may be larger
than zsrc_max.</p></li>
<li><p><strong>field_size</strong> (<em>float</em><em>, </em><em>optional</em>) -- The size of the field (field_size x field_size) to be simulated.
Proper distance in Mpc  at the cluster redshift.</p></li>
<li><p><strong>shapenoise</strong> (<em>float</em><em>, </em><em>optional</em>) -- If set, applies Gaussian shape noise to the galaxy shapes with a width set by <cite>shapenoise</cite></p></li>
<li><p><strong>mean_e_err</strong> (<em>float</em><em>, </em><em>optional</em>) -- Mean per-component ellipticity uncertainty. Currently,
individual uncertainties are drawn from a uniform distribution
in the range [0.9,1.1]*mean_e_err. If not provided, the output
table will not include this column.</p></li>
<li><p><strong>photoz_sigma_unscaled</strong> (<em>float</em><em>, </em><em>optional</em>) -- If set, applies photo-z errors to source redshifts</p></li>
<li><p><strong>nretry</strong> (<em>int</em><em>, </em><em>optional</em>) -- The number of times that we re-draw each galaxy with non-sensical derived properties</p></li>
<li><p><strong>ngals</strong> (<em>float</em><em>, </em><em>optional</em>) -- Number of galaxies to generate</p></li>
<li><p><strong>ngal_density</strong> (<em>float</em><em>, </em><em>optional</em>) -- The number density of galaxies (in galaxies per square arcminute, from z=0 to z=infty).
The number of galaxies to be drawn will then depend on the redshift distribution and
user-defined redshift range.  If specified, the ngals argument will be ignored.</p></li>
<li><p><strong>validate_input</strong> (<em>bool</em>) -- Validade each input argument</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>galaxy_catalog</strong> -- Table of source galaxies with drawn and derived properties required for lensing studies</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>clmm.GCData</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Much of this code in this function was adapted from the Dallas group</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2021, LSST DESC CLMM Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>