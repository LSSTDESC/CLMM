

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Compute boost factors &mdash; CLMM 1.4.4 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fit halo mass to shear profile: 1. ideal data" href="Example1_Fit_Halo_Mass_to_Shear_Catalog.html" />
    <link rel="prev" title="Mass conversion between spherical overdensity mass definitions" href="demo_mass_conversion.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> CLMM
          

          
          </a>

          
            
            
              <div class="version">
                1.4.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/overview.html">Rapid overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/citing.html">Using and citing CLMM</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage Demos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="demo_generate_mock_cluster.html">Generate Mock Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo_dataops_functionality.html">Measure a Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo_theory_functionality.html">Model a Galaxy Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_and_model_demo_DC2.html">Basic usage of the cosmoDC2 extragalactic catalog with CLMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo_mass_conversion.html">Mass conversion between spherical overdensity mass definitions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Compute boost factors</a></li>
</ul>
<p class="caption"><span class="caption-text">Mass Fitting Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Example1_Fit_Halo_Mass_to_Shear_Catalog.html">Fit halo mass to shear profile: 1. ideal data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example2_Fit_Halo_Mass_to_Shear_Catalog.html">Fit halo mass to shear profile: 2. realistic data and wrong model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example3_Fit_Halo_Mass_to_Shear_Catalog.html">Fit halo mass to shear profile: 3. accounting for the redshift distribution of source galaxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example1_Fit_shear_profile_with_miscentering.html">Investigate the impact of miscentering on shear profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example4_Fit_Halo_mass_to_HSC_data.html">Using CLMM on Real Datasets</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/clmm.clusterensemble.html">clmm.clusterensemble module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/clmm.constants.html">clmm.constants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/clmm.cosmology.html">clmm.cosmology package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.cosmology.ccl.html">clmm.cosmology.ccl module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.cosmology.cluster_toolkit.html">clmm.cosmology.cluster_toolkit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.cosmology.numcosmo.html">clmm.cosmology.numcosmo module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.cosmology.parent_class.html">clmm.cosmology.parent_class module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/clmm.dataops.html">clmm.dataops package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/clmm.galaxycluster.html">clmm.galaxycluster module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/clmm.gcdata.html">clmm.gcdata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/clmm.theory.html">clmm.theory package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.theory.be_setup.html">clmm.theory.be_setup module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.theory.ccl.html">clmm.theory.ccl module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.theory.cluster_toolkit.html">clmm.theory.cluster_toolkit module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.theory.func_layer.html">clmm.theory.func_layer module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.theory.generic.html">clmm.theory.generic module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.theory.numcosmo.html">clmm.theory.numcosmo module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.theory.parent_class.html">clmm.theory.parent_class module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/clmm.plotting.html">clmm.plotting package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/clmm.utils.html">clmm.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/clmm.support.html">clmm.support package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.support.mock_data.html">clmm.support.mock_data module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/clmm.support.sampler.html">clmm.support.sampler module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CLMM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Compute boost factors</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/compiled-examples/demo_boost_factors.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="compute-boost-factors">
<h1>Compute boost factors<a class="headerlink" href="#compute-boost-factors" title="Permalink to this headline">¶</a></h1>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">clmm</span>
<span class="kn">from</span> <span class="nn">clmm</span> <span class="kn">import</span> <span class="n">Cosmology</span>
<span class="kn">from</span> <span class="nn">clmm.support</span> <span class="kn">import</span> <span class="n">mock_data</span> <span class="k">as</span> <span class="n">mock</span>
<span class="kn">from</span> <span class="nn">clmm.galaxycluster</span> <span class="kn">import</span> <span class="n">GalaxyCluster</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">clmm.utils</span> <span class="k">as</span> <span class="nn">u</span>
</pre></div>
</div>
<p>Make sure we know which version we’re using</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clmm</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;1.4.4&#39;</span>
</pre></div>
</div>
<div class="section" id="define-cosmology-object">
<h2>Define cosmology object<a class="headerlink" href="#define-cosmology-object" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mock_cosmo</span> <span class="o">=</span> <span class="n">Cosmology</span><span class="p">(</span><span class="n">H0</span> <span class="o">=</span> <span class="mf">70.0</span><span class="p">,</span> <span class="n">Omega_dm0</span> <span class="o">=</span> <span class="mf">0.27</span> <span class="o">-</span> <span class="mf">0.045</span><span class="p">,</span> <span class="n">Omega_b0</span> <span class="o">=</span> <span class="mf">0.045</span><span class="p">,</span> <span class="n">Omega_k0</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>First, we want to generate a <span class="math notranslate nohighlight">\(\Delta\Sigma\)</span> (excess surface
density) profile from mock data, to which we can apply boost factors.
The mock data is generated in the following cells.</p>
<p>Generate cluster object from mock data</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">mock_cosmo</span>
<span class="n">cluster_id</span> <span class="o">=</span> <span class="s2">&quot;Awesome_cluster&quot;</span>
<span class="n">cluster_m</span> <span class="o">=</span> <span class="mf">1.e15</span>
<span class="n">cluster_z</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">concentration</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">ngals</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">zsrc_min</span> <span class="o">=</span> <span class="n">cluster_z</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="c1"># we only want to draw background galaxies</span>

<span class="n">noisy_data_z</span> <span class="o">=</span> <span class="n">mock</span><span class="o">.</span><span class="n">generate_galaxy_catalog</span><span class="p">(</span><span class="n">cluster_m</span><span class="p">,</span>
                                            <span class="n">cluster_z</span><span class="p">,</span>
                                            <span class="n">concentration</span><span class="p">,</span>
                                            <span class="n">cosmo</span><span class="p">,</span>
                                            <span class="s1">&#39;chang13&#39;</span><span class="p">,</span>
                                            <span class="n">zsrc_min</span><span class="o">=</span><span class="n">zsrc_min</span><span class="p">,</span>
                                            <span class="n">shapenoise</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
                                            <span class="n">photoz_sigma_unscaled</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ngals</span><span class="o">=</span><span class="n">ngals</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="k">global</span><span class="o">/</span><span class="n">homes</span><span class="o">/</span><span class="n">a</span><span class="o">/</span><span class="n">aguena</span><span class="o">/.</span><span class="n">conda</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">clmmenv</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">numpy</span><span class="o">/</span><span class="n">ma</span><span class="o">/</span><span class="n">core</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">2826</span><span class="p">:</span> <span class="n">VisibleDeprecationWarning</span><span class="p">:</span> <span class="n">Creating</span> <span class="n">an</span> <span class="n">ndarray</span> <span class="kn">from</span> <span class="nn">ragged</span> <span class="n">nested</span> <span class="n">sequences</span> <span class="p">(</span><span class="n">which</span> <span class="ow">is</span> <span class="n">a</span> <span class="nb">list</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="nb">tuple</span> <span class="n">of</span> <span class="n">lists</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">tuples</span><span class="o">-</span><span class="ow">or</span> <span class="n">ndarrays</span> <span class="k">with</span> <span class="n">different</span> <span class="n">lengths</span> <span class="ow">or</span> <span class="n">shapes</span><span class="p">)</span> <span class="ow">is</span> <span class="n">deprecated</span><span class="o">.</span> <span class="n">If</span> <span class="n">you</span> <span class="n">meant</span> <span class="n">to</span> <span class="n">do</span> <span class="n">this</span><span class="p">,</span> <span class="n">you</span> <span class="n">must</span> <span class="n">specify</span> <span class="s1">&#39;dtype=object&#39;</span> <span class="n">when</span> <span class="n">creating</span> <span class="n">the</span> <span class="n">ndarray</span><span class="o">.</span>
  <span class="n">_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span>
</pre></div>
</div>
<p>Loading this into a CLMM cluster object centered on (0,0)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_ra</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">cluster_dec</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">cl</span> <span class="o">=</span> <span class="n">GalaxyCluster</span><span class="p">(</span><span class="n">cluster_id</span><span class="p">,</span> <span class="n">cluster_ra</span><span class="p">,</span> <span class="n">cluster_dec</span><span class="p">,</span>
                               <span class="n">cluster_z</span><span class="p">,</span> <span class="n">noisy_data_z</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute cross and tangential excess surface density for each source
galaxy</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">compute_tangential_and_cross_components</span><span class="p">(</span>
    <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">,</span> <span class="n">shape_component1</span><span class="o">=</span><span class="s1">&#39;e1&#39;</span><span class="p">,</span> <span class="n">shape_component2</span><span class="o">=</span><span class="s1">&#39;e2&#39;</span><span class="p">,</span>
    <span class="n">tan_component</span><span class="o">=</span><span class="s1">&#39;DeltaSigma_tan&#39;</span><span class="p">,</span> <span class="n">cross_component</span><span class="o">=</span><span class="s1">&#39;DeltaSigma_cross&#39;</span><span class="p">,</span>
    <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cosmo</span><span class="o">=</span><span class="n">cosmo</span><span class="p">,</span> <span class="n">is_deltasigma</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="k">global</span><span class="o">/</span><span class="n">homes</span><span class="o">/</span><span class="n">a</span><span class="o">/</span><span class="n">aguena</span><span class="o">/.</span><span class="n">local</span><span class="o">/</span><span class="n">cori</span><span class="o">/</span><span class="mf">3.9</span><span class="o">-</span><span class="n">anaconda</span><span class="o">-</span><span class="mf">2021.11</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">clmm</span><span class="o">-</span><span class="mf">1.4.4</span><span class="o">-</span><span class="n">py3</span><span class="mf">.8</span><span class="o">.</span><span class="n">egg</span><span class="o">/</span><span class="n">clmm</span><span class="o">/</span><span class="n">utils</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">641</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Some</span> <span class="n">source</span> <span class="n">redshifts</span> <span class="n">are</span> <span class="n">lower</span> <span class="n">than</span> <span class="n">the</span> <span class="n">cluster</span> <span class="n">redshift</span><span class="o">.</span> <span class="n">Returning</span> <span class="n">Sigma_crit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span> <span class="k">for</span> <span class="n">those</span> <span class="n">galaxies</span><span class="o">.</span>
</pre></div>
</div>
<p>Calculate the binned profile</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cl</span><span class="o">.</span><span class="n">make_radial_profile</span><span class="p">(</span><span class="s2">&quot;kpc&quot;</span><span class="p">,</span> <span class="n">cosmo</span><span class="o">=</span><span class="n">cosmo</span><span class="p">,</span>
                       <span class="n">tan_component_in</span><span class="o">=</span><span class="s1">&#39;DeltaSigma_tan&#39;</span><span class="p">,</span> <span class="n">cross_component_in</span><span class="o">=</span><span class="s1">&#39;DeltaSigma_cross&#39;</span><span class="p">,</span>
                       <span class="n">tan_component_out</span><span class="o">=</span><span class="s1">&#39;DeltaSigma_tan&#39;</span><span class="p">,</span> <span class="n">cross_component_out</span><span class="o">=</span><span class="s1">&#39;DeltaSigma_cross&#39;</span><span class="p">,</span>
                       <span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;DeltaSigma_profile&#39;</span><span class="p">)</span>
<span class="c1"># Format columns for display</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="o">.</span><span class="n">colnames</span><span class="p">:</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span>
    <span class="k">if</span> <span class="s1">&#39;DeltaSigma&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;.2e&#39;</span>
    <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">typ</span> <span class="ow">in</span> <span class="n">col</span> <span class="k">for</span> <span class="n">typ</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;radius&#39;</span><span class="p">)):</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;.2f&#39;</span>
    <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">fmt</span>
<span class="c1"># Show</span>
<span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="o">.</span><span class="n">show_in_notebook</span><span class="p">()</span>
</pre></div>
</div>
<i>GCData length=10</i>
<table id="table23456172784416-123116" class="table-striped table-bordered table-condensed">
<thead><tr><th>idx</th><th>radius_min</th><th>radius</th><th>radius_max</th><th>DeltaSigma_tan</th><th>DeltaSigma_tan_err</th><th>DeltaSigma_cross</th><th>DeltaSigma_cross_err</th><th>z</th><th>z_err</th><th>n_src</th></tr></thead>
<tr><td>0</td><td>83.51</td><td>429.42</td><td>631.36</td><td>2.02e+14</td><td>1.08e+13</td><td>3.62e+12</td><td>3.86e+12</td><td>1.21</td><td>0.12</td><td>23</td></tr>
<tr><td>1</td><td>631.36</td><td>922.81</td><td>1179.21</td><td>1.22e+14</td><td>3.91e+12</td><td>-3.83e+11</td><td>2.02e+12</td><td>1.38</td><td>0.09</td><td>49</td></tr>
<tr><td>2</td><td>1179.21</td><td>1473.55</td><td>1727.07</td><td>7.98e+13</td><td>2.52e+12</td><td>-7.11e+11</td><td>1.76e+12</td><td>1.23</td><td>0.06</td><td>81</td></tr>
<tr><td>3</td><td>1727.07</td><td>2037.71</td><td>2274.92</td><td>5.79e+13</td><td>2.03e+12</td><td>-1.82e+10</td><td>1.57e+12</td><td>1.27</td><td>0.07</td><td>100</td></tr>
<tr><td>4</td><td>2274.92</td><td>2568.23</td><td>2822.77</td><td>4.34e+13</td><td>1.67e+12</td><td>2.21e+10</td><td>1.77e+12</td><td>1.35</td><td>0.08</td><td>108</td></tr>
<tr><td>5</td><td>2822.77</td><td>3087.25</td><td>3370.62</td><td>3.55e+13</td><td>1.77e+12</td><td>-7.66e+11</td><td>1.77e+12</td><td>1.23</td><td>0.05</td><td>179</td></tr>
<tr><td>6</td><td>3370.62</td><td>3638.65</td><td>3918.47</td><td>2.94e+13</td><td>1.35e+12</td><td>1.61e+12</td><td>1.34e+12</td><td>1.23</td><td>0.05</td><td>209</td></tr>
<tr><td>7</td><td>3918.47</td><td>4128.07</td><td>4466.32</td><td>2.42e+13</td><td>1.16e+12</td><td>-6.91e+11</td><td>1.41e+12</td><td>1.36</td><td>0.06</td><td>160</td></tr>
<tr><td>8</td><td>4466.32</td><td>4751.10</td><td>5014.17</td><td>2.08e+13</td><td>1.66e+12</td><td>-6.20e+11</td><td>1.90e+12</td><td>1.24</td><td>0.08</td><td>67</td></tr>
<tr><td>9</td><td>5014.17</td><td>5210.09</td><td>5562.02</td><td>1.66e+13</td><td>3.16e+12</td><td>2.37e+11</td><td>2.58e+12</td><td>1.16</td><td>0.12</td><td>24</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table23456172784416-123116').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table23456172784416-123116').dataTable({
        order: [],
        pageLength: 50,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], type: "optionalnum"}]
    });
});
</script><p>Plot the <span class="math notranslate nohighlight">\(\Delta\Sigma\)</span> profile</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan&#39;</span><span class="p">],</span>
             <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan_err&#39;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DeltaSigma profile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Radius [kpc]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\Delta\Sigma [M_\odot\; Mpc^{-2}]$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/demo_boost_factors_16_0.png" src="../_images/demo_boost_factors_16_0.png" />
<div class="section" id="boost-factors">
<h3>Boost Factors<a class="headerlink" href="#boost-factors" title="Permalink to this headline">¶</a></h3>
<p>CLMM offers two boost models, the NFW boost model, and a powerlaw boost
model.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">compute_nfw_boost</span></code> requires two parameters to be specified,
<code class="docutils literal notranslate"><span class="pre">rs</span></code> and <code class="docutils literal notranslate"><span class="pre">b0</span></code>, and <code class="docutils literal notranslate"><span class="pre">compute_powerlaw_boost</span></code> requires three
paramters, <code class="docutils literal notranslate"><span class="pre">rs</span></code>, <code class="docutils literal notranslate"><span class="pre">b0</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha</span></code>. The default values are in kpc.</p>
<p>Details on these boost models can be found
<a class="reference external" href="https://cluster-toolkit.readthedocs.io/en/latest/source/boostfactors.html">here</a></p>
<p>First, we can calculate the boost factors from the two models.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nfw_boost</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">compute_nfw_boost</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span><span class="n">rs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">b0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">powerlaw_boost</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">compute_powerlaw_boost</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span><span class="n">rs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">b0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the two boost factors, <span class="math notranslate nohighlight">\(B(R)\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span><span class="n">nfw_boost</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;NFW boost factor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span><span class="n">powerlaw_boost</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Powerlaw boost factor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Radius [kpc]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$B(R)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/demo_boost_factors_21_0.png" src="../_images/demo_boost_factors_21_0.png" />
<p>The <span class="math notranslate nohighlight">\(\Delta\Sigma\)</span> profiles can be corrected with the boost factor
using <code class="docutils literal notranslate"><span class="pre">correct_sigma_with_boost_values</span></code> or
<code class="docutils literal notranslate"><span class="pre">correct_sigma_with_boost_model</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">correct_sigma_with_boost_values</span></code> requires us to precompute the boost
factor, e.g. using <code class="docutils literal notranslate"><span class="pre">compute_nfw_boost</span></code>.
<code class="docutils literal notranslate"><span class="pre">correct_sigma_with_boost_model</span></code> simply requires us to specify the
boost model.</p>
<p>Note that the boost factor can be used in one of two ways.</p>
<p>Either the boost factor can be applied to the observed data vector to
correct for the dilution of the signal by cluster member galaxies. In
this case the amplitude of the corrected profile will increase.</p>
<p>Or the boost factor can be applied to the model prediction. In this case
it behaves as a dilution factor, and the resulting model prediction will
be lower than the original one.</p>
<p>Both scenarios will improve the agreement between the mock data and
observed data, by accounting for cluster member galaxy contamination.</p>
<p>In this notebook, we use the second approach, where the data is
generated using mock data that does not account for dilution until the
boost factor is applied. The corrected profiles from the mock data are
lower than the uncorrected one.</p>
<p>Essentially we are diluting the mock profile to mimick the effect of
contamination by cluster members.</p>
<p>First we will apply the boost factor with
<code class="docutils literal notranslate"><span class="pre">correct_sigma_with_boost_values</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Sigma_corrected_powerlaw_boost</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">correct_sigma_with_boost_values</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan&#39;</span><span class="p">],</span>
                                                                   <span class="n">powerlaw_boost</span><span class="p">)</span>
<span class="n">Sigma_corrected_nfw_boost</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">correct_sigma_with_boost_values</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan&#39;</span><span class="p">],</span>
                                                              <span class="n">nfw_boost</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the result</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">Sigma_corrected_nfw_boost</span><span class="p">,</span>
             <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan_err&#39;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\Delta \Sigma$ / NFW boost factor&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">Sigma_corrected_powerlaw_boost</span><span class="p">,</span>
             <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan_err&#39;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\Delta \Sigma$ / Powerlaw boost factor&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan&#39;</span><span class="p">],</span>
             <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan_err&#39;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;uncorrected $\Delta \Sigma$&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>

<span class="c1">#plt.loglog()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DeltaSigma profile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Radius [kpc]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\Delta\Sigma [M_\odot\; Mpc^{-2}]$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/demo_boost_factors_27_0.png" src="../_images/demo_boost_factors_27_0.png" />
<p>Now the same again but with <code class="docutils literal notranslate"><span class="pre">correct_sigma_with_boost_model</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Sigma_corrected_powerlaw_boost</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">correct_sigma_with_boost_model</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span>
                                                                   <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan&#39;</span><span class="p">],</span>
                                                                   <span class="n">boost_model</span><span class="o">=</span><span class="s1">&#39;powerlaw_boost&#39;</span><span class="p">)</span>
<span class="n">Sigma_corrected_nfw_boost</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">correct_sigma_with_boost_model</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span>
                                                              <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan&#39;</span><span class="p">],</span>
                                                              <span class="n">boost_model</span><span class="o">=</span><span class="s1">&#39;nfw_boost&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">Sigma_corrected_nfw_boost</span><span class="p">,</span>
             <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan_err&#39;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\Delta \Sigma$ / NFW boost factor&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">Sigma_corrected_powerlaw_boost</span><span class="p">,</span>
             <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan_err&#39;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\Delta \Sigma$ / Powerlaw boost factor&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">],</span> <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan&#39;</span><span class="p">],</span>
             <span class="n">cl</span><span class="o">.</span><span class="n">DeltaSigma_profile</span><span class="p">[</span><span class="s1">&#39;DeltaSigma_tan_err&#39;</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;uncorrected $\Delta \Sigma$&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>

<span class="c1">#plt.loglog()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DeltaSigma profile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Radius [kpc]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\Delta\Sigma [M_\odot\; Mpc^{-2}]$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/demo_boost_factors_29_0.png" src="../_images/demo_boost_factors_29_0.png" />
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018-2021, LSST DESC CLMM Contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>